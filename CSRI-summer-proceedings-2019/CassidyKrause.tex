\documentclass{csri19}

%%% Starting page will be changed when we combine the proceedings
\setcounter{page}{3}

% PACKAGES ---------------------------------------------------------------
\usepackage{amsfonts,amsmath,graphicx,subfigure}
% ADD YOUR OWN PACKAGES HERE ---------------------------------------------
\usepackage{mathtools, amssymb}

% DEFINITIONS ------------------------------------------------------------
% ADD YOUR OWN DEFINITIONS HERE ------------------------------------------
% BE SURE TO PREFACE LABEL WITH YOUR OWN INITIALS (SSS in this example) --
\newcommand{\SSSnorm}[1]{\left\Vert#1\right\Vert}
\newcommand{\SSSabs}[1]{\left\vert#1\right\vert}
\newcommand{\CFKg}{\mathfrak{g}}

% This controls the table-of-contents entry in the proceedings. Edit it
% to include your article title followed by the authors' names, as shown.
\addcontentsline{toc}{chapter}{Exponential Integrators for the HOMME-NH
Nonhydrostatic Atmosphere Model\\
{\em C.F.\ Krause and A.J.\ Steyer}}

\pagestyle{myheadings}

\thispagestyle{plain}

% This gives the running head. Usually you list a shortened version of
% your article title (unless it's already very short) along with
% the author's names, as shown.
\markboth{Exponential Integrators for HOMME-NH}{C.F.\ Krause and A.J.\ Steyer}

% Put your article title in here
\title{Exponential Integrators for the HOMME-NH Nonhydrostatic Atmosphere
 Model}

% List each author, their affiliation, and their e-mail address, as shown.
\author{Cassidy F.\ Krause\thanks{University of Kansas, ckrause@ku.edu}
\and Andrew J.\ Steyer\thanks{Sandia National Laboratories, asteyer@sandia.gov}}

\begin{document}
\maketitle

% Include your abstract here.
\begin{abstract}
Time-stepping in the HOMME-NH nonhydrostatic atmosphere model requires 
integration of a stiff initial value problem. The current standard is to
 solve these equations using implicit-explicit (IMEX) Runge-Kutta (RK) 
methods with a horizontally explicit - vertically implicit (HEVI) 
partitioning. We introduce a horizontally explicit - vertically integrating
 factor exponential method (HEVI-Exponential) as an alternative to solving 
these stiff equations. The main drawback to exponential methods is the cost
 of forming the matrix exponential. Here, we show that we can mitigate this 
cost by taking advantage of the tridiagonal-like form of our Jacobian and 
parallelizing our computations, making this solver an attractive option for
HOMME-NH.
\end{abstract}

\section{Introduction} \label{CFK:sec:intro}
Stiff initial value problems, like the ones found in HOMME-NH, require a 
very small step size when solved explicitly. On the other hand, using a 
fully implicit method is computationally inefficient. To deal with these 
restrictions, two different approaches have been developed for solving 
stiff equations.

Consider an equation of the form \[ u_t = f(u) = s(u) + n(u),\] where $s(u)$ 
contains the stiff part of the equation, and $n(u)$ contains the nonstiff 
part. The current implementation in HOMME-NH uses an implicit Runge-Kutta
method on $s(u)$, and an explicit Runge-Kutta method to solve $n(u)$. This 
approach is efficient and accurate, but with recent advances in 
exponential-type integrators, it is worth examining their performance as 
well.

In this paper, we consider integrating factor Runge-Kutta methods (IFRKs). 
In this case, we split our method as \[ u_t = f(u_m) = L_mu_m + N(u_m),\] 
where $L_m$ is a linear operator containing the stiff part of the equation, 
and $N(u_m) = f(u_m)-L_mu_m$ contains the nonstiff terms. Often, 
$L_m = f'(u_m)$, but we do not assume this is the case. Using the change of
 variables $v(t) = e^{-L_m(t-t_m)}u(t)$, we have
\begin{equation}\label{CFK:eqn:vode}
v_t = e^{-L_m(t-t_m)}N(e^{L_m(t-t_m)}v).
\end{equation} 
We can now use a fully explicit $r-$stage Runge Kutta method to solve 
\ref{CFK:eqn:vode}.

The most expensive part of these IFRK methods is the formation of the 
matrix exponential. However, the structure of the Jacobian in HOMME-NH 
allows us to form these matrix exponentials efficiently and in parallel, 
making this a viable alternative to the IMEX Runge-Kutta methods.

The rest of the paper is structured as follows: In section 
\ref{CFK:sec:homme}, we give a brief background of the nonhydrostatic 
model; section \ref{CFK:sec:matexp} discusses exponential integrator 
methods; the implementation of these methods is given in section 
\ref{CFK:sec:ifrk}; and numerical results are given in section 
\ref{CFK:sec:results}.

\section{Exponential Methods}\label{CFK:sec:matexp} 
The most expensive part of any exponential method is forming the matrix 
exponential $e^A$. For this reason, matrix exponential methods were not 
widely used for many years, but advances in efficiently forming $e^A$ have 
recently made exponential methods competetive choices for numerical solvers.

The matrix exponential $e^A$ can be analytically computed if the matrix $A$
 is diagonalizable, but finding the eigenvalues of $A$ is expensive, and it
 is not generally guaranteed that $A$ is diagonalizable. A more general 
approach is to approximate $e^{A}$ using a Pad\'e or Taylor series 
approximation. Other methods of approximating the matrix exponential are 
discussed in \cite{CFK:Moler2003}.

We choose to implement a $(p,q)$-Pad\'e approximation 
$e^{A}\approx \left[Q_{pq}(A)\right]^{-1}P_{pq}(A)$, where $P_{pq}(A)$ and 
$Q_{pq}(A)$ are defined as follows:

\begin{align*}
P_{pq}(A) &= \sum_{j=0}^p\frac{(p+q-j)!p!}{(p+q)!j!(p-j)!}A^j\\
Q_{pq}(A) &= \sum_{j=0}^q\frac{(p+q-j)!q!}{(p+q)!j!(q-j)!}(-A)^j
\end{align*}

The error for this approximation is given by
\[ e^A - \left[Q_{pq}(A)\right]^{-1}P_{pq}(A) = \mathcal{O}(A^{p+q+1}).\]

If the matrix $A$ has eigenvalues that are spread far apart, this 
approximation can be rather inaccuarate. To mitigate this problem, we 
implement a scaling and squaring approach. We briefly outline this 
procedure here; for further detail and error analysis of the scaling and 
squaring method, see \cite{CFK:higham2005} and \cite{CFK:Al-Mohy2009}. 

Because of the properties of matrix exponentials, we can write
\[e^{A} = \left(e^{A/k}\right)^k,\]
where $k$ is chosen to be the smallest power of $2$ so that 
$\|A/k\| \leq 0.5$. With this factorization, the matrix $A$ is scaled down
 to $A/k$, and the matrix exponential $e^{A/k}$ is calculated using the 
formulas above. This matrix exponential is then squared repeatedly to 
recover the desired matrix exponential $e^{A}$.

Once the terms $P_{pq}$ and $Q_{pq}$ are calculated, the product 
$e^A\approx\left[Q_{pq}(A)\right]^{-1}P_{pq}(A)$ is a potentially 
expensive computation because of the matrix inversion. Fortunately, for our
 application, the matrix $A$ we consider has a special structure.

\section{Implementation with HOMME-NH}\label{CFK:sec:homme}
HOMME-NH is a nonhydrostatic atmosphere model whose state variables are
listed in Table \ref{CFK:tab:variables}. The stiff terms in this model are 
$w$ and $\phi$, so we can write the governing equations as
\[q_t \coloneqq \begin{bmatrix} u_t \\
w_t\\
\phi_t\\
\theta_t\\
\frac{\partial \pi}{\partial \eta}
\end{bmatrix} = n(q) + s(q) \equiv n(q) + \begin{bmatrix}
0\\
-\CFKg (1-\mu)\\
\CFKg w\\
0\\
0\end{bmatrix}.\] 

\begin{table}[ht]
  \caption{Variables in HOMME-NH}
  \label{CFK:tab:variables}
  \begin{center}
    \begin{tabular}{|c|l|}
      \hline
      \textbf{Variable Name} & \textbf{Description} \\
      \hline
      $w$                                & Vertical velocity      \\
      $u$                                & Horizontal velocity    \\
      $\phi$                             & Geopotential           \\
      $\theta$                           & Potential temperature  \\
      $\frac{\partial\pi}{\partial\eta}$ &                        \\
      \hline
    \end{tabular}
  \end{center}
\end{table}

Linearizing $s(q)$ gives the following Jacobian:
\[ J = \begin{bmatrix}
0&                  &                                                   &  & \\
 & 0                & \CFKg \Delta t \frac{\partial \mu}{\partial \phi} &  & \\
 & \CFKg \Delta t I & 0                                                 &  & \\
 &                  &                                                   &0 & \\
 &                  &                                                   &  &0\end{bmatrix}.\]

So, forming $e^{\alpha J}$ reduces to forming an exponential of 
\[A \coloneqq \begin{bmatrix}
   0              & \CFKg \Delta t \frac{\partial \mu}{\partial \phi} \\
 \CFKg \Delta t I & 0  \end{bmatrix},\]
where $\dfrac{\partial \mu}{\partial \phi}$ is tridiagonal. This form 
allows us to solve $\left[Q_{pq}(A)\right]^{-1}P_{pq}(A)$ using 
tridiagonal solves and back substitution.

To do so, we first factor $Q_{pq}(A)$ as
\begin{align*}
Q_{pq}(A) &= \sum_{j=0}^q\frac{(p+q-j)!q!}{(p+q)!j!(q-j)!}(-A)^j\\
          &= \prod_{j=1}^q\left[\sigma_jI-A\right],
\end{align*}
where $\sigma_j\in \mathbb{C}$ for $j=1,\dots,q$.

Then, since we want to solve for 
$R \coloneqq \left[Q_{pq}(A)\right]^{-1}P_{pq}(A)$, we have
\begin{align*}
Q_{pq}(A) R &= P_{pq}(A)\\
\prod_{j=1}^q\left[\sigma_jI-A\right]R &= P_{pq}(A).
\end{align*}

Define $R_1 \coloneqq \left[\sigma_2I-A\right]\left[\sigma_3I-A\right]\cdots\left[\sigma_qI-A\right]R$.
Then our equation becomes
\[ \left[\sigma_1I-A\right]R_1 = P_{pq}(A).\] Since 
$\left[\sigma_1I-A\right]$ has some tridiagonal structure, we can solve for
 $R_1$ using far fewer operations than if $\left[\sigma_1I-A\right]$ were a
 full matrix.

Now we have
\[\left[\sigma_2I-A\right]\left[\sigma_3I-A\right]\cdots\left[\sigma_qI-A\right]R = R_1.\] 
We can continue in this way, defining 
$R_j \coloneqq \left[\sigma_{j+1}I-A\right]\left[\sigma_{j+2}I-A\right]\cdots\left[\sigma_qI-A\right]R$
 and solving
\[\left[\sigma_jI-A\right]R_j = R_{j-1}\] 
for $R_j$, until we arive at
\[\left[\sigma_qI-A\right]R = R_{q-1}.\] 
Solving this last tridiagonal system gives us the $R = \left[Q_{pq}(A)\right]^{-1}P_{pq}(A)$
 that we are looking for.

This approach is particularly efficient if the values of $p$ and $q$ are 
small, so that we can analytically find $\{\sigma_j\}_{j=1}^q$ ahead of 
time. Of course, approximations like this do rather poorly for ill-
conditioned matrices, so we must validate that these approximations work 
for the Jacobians we are interested in. To validate the Pad\'e 
approximation, we let the model spin up and consider the Jacobian at that
time. For this model, our Jacobian will have unique, purely imaginary
eigenvalues, so we can calculate the matrix exponential analytically, and 
compare it to our approximation. The following table gives the results of
 several diagonal $(p,q)$-Pad\'e approximations, for different values of
$p=q$.
\begin{table}[ht]
  \begin{center}
    \caption{Error of Pad\'e Approximation}
    \label{CFK:tab:PadeError}
    \begin{tabular}{|c|c|}
      \hline
      \textbf{Value of $p=q$} & \textbf{Error}\\
      \hline
      2 & 1.30e-10 \\
      3 & 5.25e-13 \\
      4 & 4.92e-13 \\
      5 & 5.42e-13 \\
      \hline
    \end{tabular}
  \end{center}
\end{table}

Since a $(2,2)$-Pad\'e approximation yields a considerably accurate matrix 
exponential and also gives the benefit of taking advantage of the 
tridiagonal structure, we choose to implement this method.

The implementation of HOMME-NH means that $\frac{\partial\mu}{\partial\phi}$
 is tridiagonal.  Forming the exponential via Pad\'e approximation then 
requires inverting a matrix of the following form:
\[\begin{bmatrix} 0 & \CFKg\Delta t\frac{\partial\mu}{\partial\phi} \\
    \CFKg\Delta t I & 0 \end{bmatrix} =
 \begin{bmatrix} \sigma I  & -\CFKg\Delta t \frac{\partial\mu}{\partial\phi} \\
 -\CFKg\Delta t I          & \sigma I \end{bmatrix}.\]
Consider the following linear equation:
\[\begin{bmatrix} \sigma I  & -\CFKg\Delta t \frac{\partial\mu}{\partial\phi} \\
           -\CFKg\Delta t I & \sigma I \end{bmatrix}
\begin{bmatrix} Z_1 \\
 Z_2 \end{bmatrix} = 
\begin{bmatrix} P_1 \\
 P_2 \end{bmatrix}.\]
If $\sigma = 0$ this decomposes to a tridiagonal linear solve and a trivial solve. 
If $\sigma \neq 0$, then we left multiply by $\begin{bmatrix} I & 0 \\
                                     \CFKg\Delta t \sigma^{-1}I & I \end{bmatrix}$ to obtain:
\[\begin{bmatrix} 
 \sigma I  & -\CFKg\Delta t \frac{\partial\mu}{\partial\phi} \\
         0 & \sigma I -\left(\CFKg\Delta t\right)^2  \sigma^{-1}\frac{\partial\mu}{\partial\phi}
 \end{bmatrix}
 \begin{bmatrix} Z_1 \\
 Z_2 \end{bmatrix} = 
\begin{bmatrix} P_1 \\
 \CFKg\Delta t \sigma^{-1} P_1 +  P_2 \end{bmatrix}.\]
The matrix $\sigma I -\left(\CFKg\Delta t\right)^2\sigma^{-1}\frac{\partial\mu}{\partial\phi}$ 
is tridiagonal since $\frac{\partial\mu}{\partial\phi}$ is tridiagonal. 
Therefore we can solve for $X_2$ with a tridiagonal solve of 
\[\left[\sigma I -\left(\CFKg\Delta t \right)^2  \sigma^{-1}\frac{\partial\mu}{\partial\phi}\right]Z_2
 = \CFKg\Delta t\sigma^{-1} P_1 +  P_2\]
and then form $Z_1$ as 
\[Z_1 = \sigma^{-1}\left[P_1 + \CFKg\Delta t\frac{\partial \mu}{\partial \phi}\right] Z_2.\]

\section{Integrating Factor RK Methods}\label{CFK:sec:ifrk}
We consider integrating factor Runge-Kutta methods, which were started in 
\cite{CFK:Lawson1969}, shown to be a type of exponential method RK method by
\cite{CFK:Minchev2006}, and SSP by \cite{CFK:Isherwood2018}.

We consider several explicit $r-$stage Runge-Kutta methods to solve equation
\ref{CFK:eqn:vode}. If the Butcher tableau is given by $\begin{array}{c|c}
c & A \\ \hline & b^T \end{array}$, then the solution to \ref{CFK:eqn:vode} with
initial condition $v(t_0) = v_0$ and step-size $\Delta t$ is given by
\[ \left\{\begin{array}{l} v_{m+1} = v_m + \Delta t\sum_{k=1}^r b_k 
                         e^{-L_m(t_{m,k}-t_m)}N(e^{L_m(t_{m,k}-t_m)}g_k) \\
          g_j = v_m + \Delta t \sum_{k=1}^r A_{j,k} e^{-L_m(t_{m,k} - t_m)} 
                      N(e^{L_m(t_{m,k}-t_m)}g_k), \end{array} \right. \]
for $j = 1,\dots,r$, where $t_{m,k} = t_m + c_k \Delta t$.
We consider several Runge-Kutta methods given by the
following Butcher tableaux. The naming convention we use is given by ``$ERK
-nm$,'' where $n$ is the order of the method, and $m$ is the number of
stages. The methods we consider are
\[ ERK-13: \qquad
 \begin{array}{c|ccc}
0   & 0   & 0 & 0\\
1/2 & 1/2 & 0 & 0\\
1   & 0   & 1 & 0\\
\hline
    & 0   & 1 & 0
\end{array}\]
\[ ERK-24: \qquad
\begin{array}{c|cccc}
0   & 0   & 0   & 0 & 0\\
1/2 & 1/2 & 0   & 0 & 0\\
1/2 & 0   & 1/2 & 0 & 0\\
1   & 0   & 0   & 1 & 0\\
\hline
    & 0   & 0   & 1 & 0
\end{array}\]
\[ ERK-36: \qquad
\begin{array}{c|cccccc}
0   & 0   & 0   & 0   & 0   & 0   & 0\\
1/5 & 1/5 & 0   & 0   & 0   & 0   & 0\\
1/5 & 0   & 1/5 & 0   & 0   & 0   & 0\\
1/3 & 0   & 0   & 1/3 & 0   & 0   & 0\\
2/3 & 0   & 0   & 0   & 2/3 & 0   & 0\\
1   & 1/4 & 0   & 0   & 0   & 3/4 & 0\\
\hline
    & 1/4 & 0   & 0   & 0   & 3/4 & 0
\end{array}\]
\[ ERK - 44: \qquad
\begin{array}{c|cccc}
0   & 0   & 0   & 0   & 0 \\
1/2 & 1/2 & 0   & 0   & 0 \\
1/2 & 0   & 1/2 & 0   & 0 \\
1   & 0   & 0   & 1   & 0 \\
\hline
    & 1/6 & 1/3 & 1/3 & 1/6
\end{array} 
\]

\section{Results}\label{CFK:sec:results}
The convergence test was done for each of the methods described in section
 \ref{CFK:sec:ifrk}. For the ``truth'', we compare our 
exponential integrating factor methods to a third order, five stage 
Ullrich method with a timestep of $10^{-5}$. The results are as follows:
\begin{table}
  \centering
  \caption{Absolute error of state variables}
  \label{CFK:tab:abs_err}
  \subtable[Absolute error of $u$]{\begin{tabular}{c|c|c}
      \textbf{Method} & \textbf{$\Delta t$} & \textbf{Error}\\
      \hline
      ERK-13          & $0.1$             & $3.11$e-$-4$ \\
      ERK-13          & $0.01$            & $3.12$e-$-6$ \\
      ERK-13          & $0.001$           & $1.07$e-$-6$ \\
      \hline
      ERK-24          & $0.1$             & $2.84$e-$-4$ \\
      ERK-24          & $0.01$            & $2.83$e-$-6$ \\
      ERK-24          & $0.001$           & $1.07$e-$-6$ \\
      \hline
      ERK-36          & $0.1$             & $1.07$e-$-6$ \\
      ERK-36          & $0.01$            & $1.07$e-$-6$ \\
      ERK-36          & $0.001$           & $1.07$e-$-6$ \\
      \hline
      ERK-44          & $0.1$             & $1.07$e-$-6$ \\
      ERK-44          & $0.01$            & $1.07$e-$-6$ \\
      ERK-44          & $0.001$           & $1.07$e-$-6$
    \end{tabular}}
  \qquad
  \subtable[Absolute error of $v$]{\begin{tabular}{c|c|c}
      \textbf{Method} & \textbf{$\Delta t$} & \textbf{Error}\\
      \hline
      ERK-13          & $0.1$             & $3.22$e-$-4$ \\
      ERK-13          & $0.01$            & $3.22$e-$-6$ \\
      ERK-13          & $0.001$           & $6.52$e-$-7$ \\
      \hline
      ERK-24          & $0.1$             & $2.93$e-$-4$ \\
      ERK-24          & $0.01$            & $2.93$e-$-6$ \\
      ERK-24          & $0.001$           & $6.52$e-$-7$ \\
      \hline
      ERK-36          & $0.1$             & $6.55$e-$-7$ \\
      ERK-36          & $0.01$            & $6.52$e-$-7$ \\
      ERK-36          & $0.001$           & $6.52$e-$-7$ \\
      \hline
      ERK-44          & $0.1$             & $6.53$e-$-7$ \\
      ERK-44          & $0.01$            & $6.52$e-$-7$ \\
      ERK-44          & $0.001$           & $6.52$e-$-7$
    \end{tabular}}\\

  \subtable[Absolute error of $w$]{\begin{tabular}{c|c|c}
      \textbf{Method} & \textbf{$\Delta t$} & \textbf{Error}\\
      \hline
      ERK-13          & $0.1$             & $1.02$e-$-1$ \\
      ERK-13          & $0.01$            & $1.02$e-$-3$ \\
      ERK-13          & $0.001$           & $1.11$e-$-5$ \\
      \hline
      ERK-24          & $0.1$             & $1.02$e-$-1$ \\
      ERK-24          & $0.01$            & $1.02$e-$-3$ \\
      ERK-24          & $0.001$           & $1.11$e-$-5$ \\
      \hline
      ERK-36          & $0.1$             & $7.54$e-$-4$ \\
      ERK-36          & $0.01$            & $2.00$e-$-6$ \\
      ERK-36          & $0.001$           & $1.49$e-$-6$ \\
      \hline
      ERK-44          & $0.1$             & $2.30$e-$-4$ \\
      ERK-44          & $0.01$            & $1.49$e-$-6$ \\
      ERK-44          & $0.001$           & $1.49$e-$-6$
    \end{tabular}}\qquad
  \subtable[Absolute error of $\phi$]{\begin{tabular}{c|c|c}
      \textbf{Method} & \textbf{$\Delta t$} & \textbf{Error}\\
      \hline
      ERK-13          & $0.1$             & $1.81$e-$-1$ \\
      ERK-13          & $0.01$            & $1.81$e-$-3$ \\
      ERK-13          & $0.001$           & $1.16$e-$-4$ \\
      \hline
      ERK-24          & $0.1$             & $1.81$e-$-1$ \\
      ERK-24          & $0.01$            & $1.81$e-$-3$ \\
      ERK-24          & $0.001$           & $1.16$e-$-4$ \\
      \hline
      ERK-36          & $0.1$             & $3.70$e-$-3$ \\
      ERK-36          & $0.01$            & $1.15$e-$-4$ \\
      ERK-36          & $0.001$           & $1.15$e-$-4$ \\
      \hline
      ERK-44          & $0.1$             & $4.19$e-$-4$ \\
      ERK-44          & $0.01$            & $1.15$e-$-4$ \\
      ERK-44          & $0.001$           & $1.15$e-$-4$
    \end{tabular}}
\end{table}

\begin{table}
  \centering
  \caption{Relative error of state variables}
  \label{CFK:tab:rel_err}
  \subtable[Relative error of $u$]{\begin{tabular}{c|c|c}
      \textbf{Method} & \textbf{$\Delta t$} & \textbf{Error}\\
      \hline
      ERK-13          & $0.1$             & $3.48$e-$-6$ \\
      ERK-13          & $0.01$            & $6.31$e-$-8$ \\
      ERK-13          & $0.001$           & $6.31$e-$-8$ \\
      \hline
      ERK-24          & $0.1$             & $3.17$e-$-6$ \\
      ERK-24          & $0.01$            & $6.31$e-$-8$ \\
      ERK-24          & $0.001$           & $6.31$e-$-8$ \\
      \hline
      ERK-36          & $0.1$             & $6.31$e-$-8$ \\
      ERK-36          & $0.01$            & $6.31$e-$-8$ \\
      ERK-36          & $0.001$           & $6.31$e-$-8$ \\
      \hline
      ERK-44          & $0.1$             & $6.31$e-$-8$ \\
      ERK-44          & $0.01$            & $6.31$e-$-8$ \\
      ERK-44          & $0.001$           & $6.31$e-$-8$
    \end{tabular}}
  \qquad
  \subtable[Relative error of $v$]{\begin{tabular}{c|c|c}
      \textbf{Method} & \textbf{$\Delta t$} & \textbf{Error}\\
      \hline
      ERK-13          & $0.1$             & $1.79$e-$+1$ \\
      ERK-13          & $0.01$            & $8.88$e-$-1$ \\
      ERK-13          & $0.001$           & $8.88$e-$-1$ \\
      \hline
      ERK-24          & $0.1$             & $1.68$e-$+1$ \\
      ERK-24          & $0.01$            & $8.95$e-$-1$ \\
      ERK-24          & $0.001$           & $8.88$e-$-1$ \\
      \hline
      ERK-36          & $0.1$             & $8.88$e-$-1$ \\
      ERK-36          & $0.01$            & $8.88$e-$-1$ \\
      ERK-36          & $0.001$           & $8.88$e-$-1$ \\
      \hline
      ERK-44          & $0.1$             & $8.88$e-$-1$ \\
      ERK-44          & $0.01$            & $8.88$e-$-1$ \\
      ERK-44          & $0.001$           & $8.88$e-$-1$
    \end{tabular}}\\

  \subtable[Relative error of $w$]{\begin{tabular}{c|c|c}
      \textbf{Method} & \textbf{$\Delta t$} & \textbf{Error}\\
      \hline
      ERK-13          & $0.1$             & $1.41$e-$+8$ \\
      ERK-13          & $0.01$            & $1.41$e-$+6$ \\
      ERK-13          & $0.001$           & $1.41$e-$+4$ \\
      \hline
      ERK-24          & $0.1$             & $1.41$e-$+8$ \\
      ERK-24          & $0.01$            & $1.41$e-$+6$ \\
      ERK-24          & $0.001$           & $1.41$e-$+4$ \\
      \hline
      ERK-36          & $0.1$             & $1.04$e-$+6$ \\
      ERK-36          & $0.01$            & $1.09$e-$+3$ \\
      ERK-36          & $0.001$           & $5.27$e-$+1$ \\
      \hline
      ERK-44          & $0.1$             & $3.18$e-$+5$ \\
      ERK-44          & $0.01$            & $8.82$e-$+1$ \\
      ERK-44          & $0.001$           & $5.18$e-$+1$
    \end{tabular}}\qquad
  \subtable[Relative error of $\phi$]{\begin{tabular}{c|c|c}
      \textbf{Method} & \textbf{$\Delta t$} & \textbf{Error}\\
      \hline
      ERK-13          & $0.1$             & $7.15$e-$-7$ \\
      ERK-13          & $0.01$            & $7.17$e-$-9$ \\
      ERK-13          & $0.001$           & $4.60$e-$-10$ \\
      \hline
      ERK-24          & $0.1$             & $7.15$e-$-7$ \\
      ERK-24          & $0.01$            & $7.17$e-$-9$ \\
      ERK-24          & $0.001$           & $4.60$e-$-10$ \\
      \hline
      ERK-36          & $0.1$             & $1.47$e-$-8$ \\
      ERK-36          & $0.01$            & $4.53$e-$-10$ \\
      ERK-36          & $0.001$           & $4.53$e-$-10$ \\
      \hline
      ERK-44          & $0.1$             & $1.66$e-$-9$ \\
      ERK-44          & $0.01$            & $4.53$e-$-10$ \\
      ERK-44          & $0.001$           & $4.53$e-$-10$
    \end{tabular}}
\end{table}




\begin{figure}[hbh]
\label{CFK:fig:convtest}
\begin{center}
\begin{tabular}{cc}
\scalebox{0.15}{\includegraphics{plots/CFKu_err.png}} 
&
\scalebox{0.15}{\includegraphics{plots/CFKu_err_rel.png}}
\\
\scalebox{0.15}{\includegraphics{plots/CFKv_err.png}} 
&
\scalebox{0.15}{\includegraphics{plots/CFKv_err_rel.png}}
\end{tabular}
\end{center}
\caption{Errors with exponential integrating factor methods.}
\end{figure}

\begin{figure}[hbh]
\label{CFK:fig:convtest1}
\begin{center}
\begin{tabular}{cc}
\scalebox{0.15}{\includegraphics{plots/CFKw_err.png}} 
&
\scalebox{0.15}{\includegraphics{plots/CFKw_err_rel.png}}
\\
\scalebox{0.15}{\includegraphics{plots/CFKphi_err.png}} 
&
\scalebox{0.15}{\includegraphics{plots/CFKphi_err_rel.png}}
\end{tabular}
\end{center}
\caption{Errors with exponential integrating factor methods, continued.}
\end{figure}

\section{Conclusions}

\bibliographystyle{siam}
% Edit the line below to be your first and last names.
\bibliography{CassidyKrause}

% Edit FirstnameLastname below to be your first and last names, but leave the line commented out.
% This line will help me merge bibliographies for the proceedings.
%\input{CassidyKrause.bbl}

\end{document}
